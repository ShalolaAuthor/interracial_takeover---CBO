# character interaction for sneaking a BBC into a foreign court

sneak_bbc = {
	category = interaction_category_diplomacy
	interface_priority = 999
	icon = icon_sneak_bbc
	common_interaction = yes
	force_notification = yes
	greeting = negative
	desc = sneak_bbc_desc
	use_diplomatic_range = yes
	
	populate_actor_list = {
		scope:actor = {
			every_courtier = {
				limit = {
					bno_adult_bbc_actor_trigger = yes
				}
				add_to_list = characters
			}
		}
	}
	
	cooldown_against_recipient = { months = 6 }

	is_shown = {
		NOT = { scope:recipient = scope:actor }
		scope:recipient = { 
			is_ruler = yes
			is_adult = yes
			is_bbc = no
		}
		scope:actor = {
			bno_basic_interaction_valid_actor = yes
		}
	}

	is_valid_showing_failures_only = {
		scope:actor = {
			custom_tooltip = {
				text = sneak_bbc.has_bbc_in_court
				bno_is_there_any_bbc_courtier = yes
			}
			trigger_if = {
				limit = { is_a_girl = yes }
				custom_tooltip = {
					text = sneak_bbc.not_enough_of_a_slut
					is_bno_snowbunny_and_up = yes
				}
			}
		}
		scope:recipient = {
			custom_tooltip = {
				text = sneak_bbc.already_has_bbc_in_court
				any_courtier = {
					is_bbc = yes
					count < 3
				}
			}
		}
	}
	
	on_accept = {
		scope:actor = {
			send_interface_toast = {
				title = sneak_bbc
				right_icon = scope:recipient
				left_icon = scope:secondary_actor
				add_character_modifier = bno_sneak_bbc
				scope:recipient = {
					add_courtier = scope:secondary_actor
				}
			}
		}
	}
	
	ai_accept = {
		base = -30
		opinion_modifier = { # Opinion Factor
			who = scope:recipient
			opinion_target = scope:actor
			multiplier = 1.0
			desc = AI_OPINION_REASON
		}
		modifier = {
			add = 5
			desc = BBC_cg_spy_reason
			scope:recipient = {
				any_courtier_or_guest = {
					has_trait = bno_whitegirl
				}
			}
		}
		
		modifier = {
			add = 10
			desc = BBC_family_spy_reason
			scope:recipient = {
				any_close_family_member = {
					is_slut = yes
				}
			}
		}
		
		modifier = {
			add = 10
			desc = BBC_curious_reason
			scope:recipient = {
				is_bno_curious = yes
			}
		}
		
		modifier = {
			add = 25
			desc = BBC_fucked_reason
			scope:recipient = {
				is_bno_snowbunny_and_up = yes
			}
		}
		
		modifier = {
			add = 50
			desc = BBC_slut_reason
			scope:recipient = {
				is_bno_mindless_bbc_slut = yes
			}
		}
	}

	ai_targets = {
		ai_recipients = neighboring_rulers_including_tributary_borders
		ai_recipients = peer_vassals
		ai_recipients = vassals
		ai_recipients = tributaries
		ai_recipients = liege
		ai_recipients = suzerain
	}

	ai_frequency = 6

	ai_potential = {
		bno_basic_interaction_valid_actor = yes
		bno_is_there_any_bbc_courtier = yes
	}

	ai_will_do = {
        base = 0
        bno_white_girl_modifier_biggest = yes
    }
}
