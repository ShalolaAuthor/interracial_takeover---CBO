on_birth_child = {
	on_actions = {
		bno_blood_inheritance_normal
		bno_blood_inheritance_abnormal
		bno_legacy_birth
	}
}

bno_blood_inheritance_normal = {
	trigger = {
		has_game_rule = bno_mod_status_on
		has_game_rule = bno_black_cum_potency_normal
	}
	effect = {
		bno_flag_inheritance = yes
		bno_normal_african_inheritance = yes
	}
}

bno_blood_inheritance_abnormal = {
	trigger = {
		has_game_rule = bno_mod_status_on
		has_game_rule = bno_black_cum_potency_abnormal
	}
	effect = {
		bno_flag_inheritance = yes
		bno_abnormal_african_inheritance = yes
	}
}


on_birth_mother = {
	on_actions = {
		black_bred_bitch
		white_breeder_on_birth_mother
		bno_birth_pussy_wear
		bno_black_birth
	}
}

bno_black_birth = {
	trigger = {
		has_game_rule = bno_mod_status_on
		has_game_rule = bno_black_birth_on
	}
	effect = {
		scope:mother ?= {
			if = {
				limit = {
					has_character_flag = bno_white_breeder_flag
					scope:child ?= {
						has_trait = bno_blood
					}
				}
				add_character_modifier = bno_white_breeder
			}
		}
		if = {
			limit = {
				scope:child ?= {
					has_trait = bno_blood
				}
				scope:real_father ?= {
					is_bbc = yes
					NOT = { is_spouse_of = scope:mother }
				}
				scope:father ?= {
					is_bbc = no
					is_spouse_of = scope:mother
				}
			}
			scope:mother = {
				trigger_event = {
					id = bno_black_birth.0001
					delayed = yes
				}
			}
		}
	}
}

bno_birth_pussy_wear = {
	effect = {
		bno_increase_pussy_wear = yes
	}
}

black_bred_bitch = {
	effect = {
		if = {
			limit = {
				scope:real_father = {
					has_trait = bno_bbc
				}
			}
			bno_increase_sluttyness = yes
		}
		if = {
			limit = {
				NOT = { exists = scope:real_father }
				scope:father ?= {
					is_bbc = yes
				}
			}
			bno_increase_sluttyness = yes
		}
		if = {
			limit = {
				NOT = { is_spouse_of = scope:real_father }
				scope:real_father = {
					is_alive = yes
					is_bbc = yes
				}
			}
			scope:real_father ?= {				#send notification and prestige to BBC real father, assuming he is not married to the mother in question
				send_interface_message = {
					type = bno_blacked_events
					title = bno_birth_real_father_notification.title
					right_icon = scope:mother
					left_icon = scope:child
					desc = bno_birth_real_father_notification.desc
					add_prestige = 75
				}
			}
		}
		if = {
			limit = {
				scope:father ?= {
					is_bbc = no
				}
			}
			scope:father ?= {
				send_interface_message = {
					type = bno_blacked_events
					title = bno_birth_cuck_father_notification.title
					right_icon = scope:mother
					left_icon = scope:child
					desc = bno_birth_cuck_father_notification.desc
				}
			}
		}
	}
}

white_breeder_on_birth_mother = {
	events = {
		bno_birth.0001 		#check if white breeder can be applied to mother
	}
}

on_birth_father = {
	on_actions = {
		bull_breeder
	}
}

bull_breeder = {
	events = {
		bno_birth.0002 #check if bull breeder modifier can be applied to father
	}
}

bno_legacy_birth = {
	effect = {
		hidden_effect = {
			if = {
				limit = {
					exists = scope:child.dynasty
					scope:child.dynasty = {
						has_dynasty_perk = bno_embrace_african_2
					}
					OR = {
						scope:mother.dynasty = scope:child.dynasty
						scope:real_father.dynasty = scope:child.dynasty
					}
				}
				if = {
					limit = {
						scope:child.dynasty = {
							exists = var:bno_embrace_african_2_bno_curious
						}
						is_a_girl = yes
						NOT = {
							has_trait = bno_curious
						}
					}
					random = {
						chance = bno_embrace_african_2_chance
						modifier = {
							add = bno_embrace_african_2_extra_player_chance
							any_parent = {
								is_ai = no
							}
						}
						add_trait = bno_curious
					}
				}
				else_if = {
					limit = {
						scope:child.dynasty = {
							exists = var:bno_embrace_african_2_bno_bbc
						}
						is_a_male = yes
						NOT = {
							has_trait = bno_bbc
						}
					}
					random = {
						chance = bno_embrace_african_2_chance
						modifier = {
							add = bno_embrace_african_2_extra_player_chance
							any_parent = {
								is_ai = no
							}
						}
						add_trait = bno_full_black
						bno_add_bbc_trait_effect = yes
					}
				}
			}
		}
	}
}